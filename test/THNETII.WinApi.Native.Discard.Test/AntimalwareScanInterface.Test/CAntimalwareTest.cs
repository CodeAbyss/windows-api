using System;
using System.Diagnostics.CodeAnalysis;
using System.Runtime.InteropServices;
using Xunit;

namespace THNETII.WinApiNative.AntimalwareScanInterface.Test
{
    public class CAntimalwareTest
    {
        [SkippableFact]
        [SuppressMessage("Usage", "PC001:API not supported on all platforms")]
        public void GetCAntimalwareInstance()
        {
            Type coclasstype;
            try
            {
                coclasstype = Marshal.GetTypeFromCLSID(__AMSI_H__.CLSID_Antimalware);
            }
            catch (PlatformNotSupportedException except)
            {
                Skip.If(true, except.Message);
                return;
            }
            var instance = Activator.CreateInstance(coclasstype);
            var antimalware = instance as IAntimalware;
            var antimalwareprovider = instance as IAntimalwareProvider;
        }
    }
}
