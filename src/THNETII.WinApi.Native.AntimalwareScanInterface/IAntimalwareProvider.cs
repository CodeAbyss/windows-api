using System;
using System.Runtime.InteropServices;

namespace THNETII.WinApi.Native.AntimalwareScanInterface
{
    /// <summary>
    /// Represents the provider of the antimalware product.
    /// </summary>
    /// <remarks>
    /// <para>Original MSDN documentation page: <a href="https://docs.microsoft.com/en-us/windows/desktop/api/amsi/nn-amsi-iantimalwareprovider">IAntimalwareProvider interface</a></para>
    /// </remarks>
    [ComImport, Guid("b2cabfe3-fe04-42b1-a5df-08d483d4d125")]
    [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
    public interface IAntimalwareProvider
    {
        #region IAntimalwareProvider::Scan method
        /// <summary>
        /// Scan a stream of content.
        /// </summary>
        /// <param name="stream">The <see cref="IAmsiStream"/> stream to be scanned.</param>
        /// <returns>
        /// The result of the scan. See <see cref="AMSI_RESULT"/>.
        /// </returns>
        /// <remarks>
        /// <para>Original MSDN documentation page: <a href="https://docs.microsoft.com/en-us/windows/desktop/api/amsi/nf-amsi-iantimalwareprovider-scan">IAntimalwareProvider::Scan method</a></para>
        /// </remarks>
        /// <seealso cref="AMSI_RESULT"/>
        /// <seealso cref="IAmsiStream"/>
        /// <seealso cref="IAntimalwareProvider"/>
        AMSI_RESULT Scan(
            [In, MarshalAs(UnmanagedType.Interface)] IAmsiStream stream
            );
        #endregion
        #region IAntimalwareProvider::CloseSession method
#pragma warning disable CS1591 // Missing XML comment for publicly visible type or member
        void CloseSession(ulong session);
#pragma warning restore CS1591 // Missing XML comment for publicly visible type or member
        #endregion
        #region IAntimalwareProvider::DisplayName method
        /// <summary>
        /// The name of the antimalware provider to be displayed.
        /// </summary>
        /// <returns>
        /// A <see cref="string"/> that contains the display name.
        /// </returns>
        /// <remarks>
        /// <para>Original MSDN documentation page: <a href="https://docs.microsoft.com/en-us/windows/desktop/api/amsi/nf-amsi-iantimalwareprovider-displayname">IAntimalwareProvider::DisplayName method</a></para>
        /// </remarks>
        /// <seealso cref="IAntimalwareProvider"/>
        [return: MarshalAs(UnmanagedType.LPWStr)]
        string DisplayName();
        #endregion
    }
}
