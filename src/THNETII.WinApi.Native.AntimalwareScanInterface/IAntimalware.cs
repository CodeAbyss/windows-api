using System;
using System.Runtime.InteropServices;

namespace THNETII.WinApi.Native.AntimalwareScanInterface
{
    using static AMSI_RESULT;

    /// <summary>
    /// Represents the antimalware product.
    /// </summary>
    /// <remarks>
    /// <para>Original MSDN documentation page: <a href="https://docs.microsoft.com/en-us/windows/desktop/api/amsi/nn-amsi-iantimalware">IAntimalware interface</a></para>
    /// </remarks>
    [ComImport, Guid("82d29c2e-f062-44e6-b5c9-3d9a2f24a2df")]
    [InterfaceType(ComInterfaceType.InterfaceIsIUnknown)]
    public interface IAntimalware
    {
        #region IAntimalware::Scan method
        /// <summary>
        /// Scan a stream of content.
        /// </summary>
        /// <param name="stream">The <see cref="IAmsiStream"/> stream to be scanned.</param>
        /// <param name="result">The result of the scan. See <see cref="AMSI_RESULT"/>.</param>
        /// <returns>The <see cref="IAntimalwareProvider"/> provider of the antimalware product.</returns>
        /// <exception cref="ArgumentException">One or more argument is invalid. </exception>
        /// <exception cref="COMException"><see cref="Exception.HResult"/> = <see cref="E_NOT_VALID_STATE"/>: The object is not initialized. </exception>
        /// <remarks>
        /// <para>Original MSDN documentation page: <a href="https://docs.microsoft.com/en-us/windows/desktop/api/amsi/nf-amsi-iantimalware-scan">IAntimalware::Scan method</a></para>
        /// </remarks>
        /// <seealso cref="AMSI_RESULT"/>
        /// <seealso cref="IAmsiStream"/>
        /// <seealso cref="IAntimalware"/>
        /// <seealso cref="IAntimalwareProvider"/>
        [return: MarshalAs(UnmanagedType.Interface)]
        IAntimalwareProvider Scan(
            [MarshalAs(UnmanagedType.Interface)] IAmsiStream stream,
            out AMSI_RESULT result
            );
        #endregion
    }
}
